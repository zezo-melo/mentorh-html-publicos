<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>OSM ¬∑ Trilha Duolingo + Quiz ‚Äì N√∫cleo Convocados</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * { box-sizing: border-box; }
    :root {
      --bg-main: #020617;
      --bg-card: #020617;
      --bg-soft: #0b1220;
      --border-soft: #1e293b;
      --text-main: #f9fafb;
      --text-soft: #9ca3af;
      --accent: #22c55e;
      --accent-soft: #4ade80;
      --bronze: #cd7f32;
      --silver: #c0c0c0;
      --gold: #facc15;
      --diamond: #38bdf8;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #020617 0, #020617 45%, #000 100%);
      color: var(--text-main);
    }
    .page {
      max-width: 1160px;
      margin: 18px auto;
      padding: 20px 22px 24px;
      background: radial-gradient(circle at top, rgba(15,23,42,0.96), #020617 70%);
      border-radius: 26px;
      border: 1px solid rgba(148,163,184,0.45);
      box-shadow: 0 24px 80px rgba(0,0,0,0.9);
    }
    h1 {
      margin: 0 0 4px;
      font-size: 1.35rem;
      letter-spacing: .04em;
    }
    .subtitle {
      font-size: .85rem;
      color: var(--text-soft);
      margin-bottom: 14px;
      max-width: 980px;
    }

    .top-summary {
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-bottom:12px;
      font-size:.8rem;
    }
    .chip {
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.55);
      background:rgba(15,23,42,0.95);
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .chip span.label {
      color:var(--text-soft);
    }
    .chip span.value {
      font-weight:600;
      color:var(--accent-soft);
    }

    .layout {
      display:grid;
      grid-template-columns:minmax(0, 2fr) minmax(0, 1.15fr);
      gap:14px;
    }

    .card {
      background:var(--bg-card);
      border-radius:18px;
      border:1px solid var(--border-soft);
      padding:10px 12px;
      box-shadow:0 18px 40px rgba(0,0,0,0.7);
    }

    .trilha-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      margin-bottom:6px;
      font-size:.8rem;
    }
    .trilha-header-title {
      font-weight:600;
    }
    .trilha-header-sub {
      font-size:.76rem;
      color:var(--text-soft);
    }

    .duo-layout {
      display:flex;
      gap:12px;
      margin-top:4px;
    }
    .duo-path {
      flex:1;
      position:relative;
      padding-left:38px;
    }
    .duo-rail {
      position:absolute;
      top:0;
      bottom:0;
      left:17px;
      width:4px;
      background:linear-gradient(#1f2937, #0f172a);
      border-radius:999px;
    }

    .tier-block {
      margin-bottom:18px;
      position:relative;
    }
    .tier-heading {
      display:flex;
      align-items:flex-start;
      gap:8px;
      margin-bottom:6px;
      font-size:.8rem;
    }
    .medal-pill {
      display:inline-flex;
      align-items:center;
      gap:4px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid var(--border-soft);
      background:#020617;
      font-size:.75rem;
      flex-shrink:0;
    }
    .medal-pill span.icon {
      font-size:1.1rem;
    }
    .medal-pill.bronze  { border-color:var(--bronze);  box-shadow:0 0 8px rgba(205,127,50,0.6);}
    .medal-pill.silver  { border-color:var(--silver);  box-shadow:0 0 8px rgba(192,192,192,0.6);}
    .medal-pill.gold    { border-color:var(--gold);    box-shadow:0 0 8px rgba(250,204,21,0.6);}
    .medal-pill.diamond { border-color:var(--diamond); box-shadow:0 0 8px rgba(56,189,248,0.6);}

    .tier-desc {
      font-size:.75rem;
      color:var(--text-soft);
      margin-top:2px;
    }
    .tier-lock {
      font-size:.72rem;
      color:var(--text-soft);
      display:flex;
      align-items:center;
      gap:4px;
      margin-top:2px;
    }

    .bau {
      position:absolute;
      right:0;
      top:2px;
      width:46px;
      height:46px;
      border-radius:14px;
      border:1px solid #111827;
      background:radial-gradient(circle at 30% 20%, #020617, #020617 70%);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:1.6rem;
      box-shadow:0 12px 26px rgba(0,0,0,0.9);
    }
    .bau.locked {
      opacity:.35;
    }
    .bau.open {
      border-color:var(--accent);
      box-shadow:0 0 0 2px rgba(34,197,94,0.7), 0 14px 30px rgba(0,0,0,1);
    }

    .percurso {
      position:relative;
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-bottom:12px;
    }
    .percurso-node {
      width:34px;
      height:34px;
      border-radius:999px;
      background:#020617;
      border:2px solid #1f2937;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:.9rem;
      box-shadow:0 8px 18px rgba(0,0,0,0.8);
      flex-shrink:0;
      position:relative;
      z-index:1;
    }
    .percurso-node.completed {
      background:radial-gradient(circle at 30% 20%, #22c55e, #14532d 70%);
      border-color:#22c55e;
      color:#f9fafb;
      box-shadow:0 0 0 2px rgba(34,197,94,0.7),0 10px 22px rgba(0,0,0,0.9);
    }
    .percurso-node.locked {
      opacity:.3;
      box-shadow:none;
    }

    .percurso-line {
      position:absolute;
      left:32px;
      right:6px;
      top:17px;
      height:2px;
      background:linear-gradient(90deg, rgba(55,65,81,0.9), rgba(55,65,81,0.1));
      z-index:0;
    }

    .percurso-card {
      flex:1;
      border-radius:12px;
      border:1px solid #111827;
      background:#020617;
      padding:6px 8px;
      font-size:.74rem;
    }
    .percurso-title {
      font-weight:600;
      margin-bottom:2px;
    }
    .percurso-detail {
      color:var(--text-soft);
      margin-bottom:4px;
    }
    .percurso-meta {
      font-size:.7rem;
      color:var(--text-soft);
      margin-bottom:4px;
    }
    .percurso-actions {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      flex-wrap:wrap;
    }
    .status-label {
      font-size:.7rem;
      color:var(--text-soft);
    }
    .status-label.ok {
      color:var(--accent-soft);
      font-weight:600;
    }
    button {
      border:none;
      border-radius:999px;
      padding:4px 10px;
      font-size:.72rem;
      cursor:pointer;
      background:linear-gradient(135deg, #16a34a, #4ade80);
      color:#022c22;
      font-weight:600;
      box-shadow:0 8px 18px rgba(22,163,74,0.6);
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    button:disabled {
      opacity:.35;
      cursor:default;
      box-shadow:none;
    }
    button.secondary {
      background:#020617;
      color:var(--text-soft);
      border:1px solid #1f2937;
      box-shadow:none;
      font-weight:500;
    }

    .side-title {
      font-size:.8rem;
      font-weight:600;
      margin-bottom:6px;
    }
    .emblema-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(130px,1fr));
      gap:6px;
      margin-bottom:8px;
    }
    .emblema-card {
      border-radius:14px;
      border:1px solid var(--border-soft);
      background:radial-gradient(circle at top, #020617, #020617 70%);
      padding:6px 7px;
      font-size:.72rem;
      display:flex;
      align-items:flex-start;
      gap:6px;
    }
    .emblema-icon {
      width:26px;
      height:26px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:1.2rem;
      box-shadow:0 0 10px rgba(0,0,0,0.9);
      flex-shrink:0;
    }
    .emblema-icon.bronze { background:#451a03; }
    .emblema-icon.silver { background:#020617; border:1px solid var(--silver); }
    .emblema-icon.gold { background:#422006; }
    .emblema-icon.diamond { background:#082f49; }

    .emblema-text-title {
      font-weight:600;
      margin-bottom:2px;
    }
    .emblema-text-title.bronze { color:var(--bronze); }
    .emblema-text-title.silver { color:var(--silver); }
    .emblema-text-title.gold { color:var(--gold); }
    .emblema-text-title.diamond { color:var(--diamond); }

    .emblema-text-desc {
      color:var(--text-soft);
    }

    .side-note {
      font-size:.72rem;
      color:var(--text-soft);
      border-top:1px dashed var(--border-soft);
      padding-top:6px;
      margin-top:4px;
    }

    .footer-note {
      margin-top:12px;
      font-size:.7rem;
      color:var(--text-soft);
      text-align:right;
    }

    /* MODAL DE QUIZ (estilo H5P simplificado) */
    .quiz-modal {
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .quiz-modal.active {
      display:flex;
    }
    .quiz-backdrop {
      position:absolute;
      inset:0;
      background:rgba(15,23,42,0.85);
      backdrop-filter:blur(4px);
    }
    .quiz-panel {
      position:relative;
      max-width:720px;
      width:92%;
      background:#020617;
      border-radius:18px;
      border:1px solid #1e293b;
      padding:14px 16px 12px;
      box-shadow:0 24px 60px rgba(0,0,0,0.95);
      z-index:10;
    }
    .quiz-header {
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
      margin-bottom:8px;
    }
    .quiz-title {
      font-size:.9rem;
      font-weight:600;
    }
    .quiz-subtitle {
      font-size:.75rem;
      color:var(--text-soft);
      margin-top:2px;
    }
    .quiz-close {
      border:none;
      background:transparent;
      color:var(--text-soft);
      font-size:1rem;
      cursor:pointer;
    }
    .quiz-progress {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      font-size:.74rem;
      margin-bottom:6px;
    }
    .quiz-bar {
      flex:1;
      height:6px;
      border-radius:999px;
      background:#020617;
      border:1px solid #1f2937;
      overflow:hidden;
    }
    .quiz-bar-fill {
      height:100%;
      width:0%;
      background:linear-gradient(90deg,#22c55e,#4ade80);
      transition:width .15s ease-out;
    }
    .quiz-question {
      font-size:.85rem;
      margin-bottom:8px;
    }
    .quiz-options {
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom:8px;
    }
    .quiz-option {
      border-radius:12px;
      border:1px solid #1f2937;
      background:#020617;
      padding:6px 8px;
      font-size:.8rem;
      cursor:pointer;
      display:flex;
      gap:6px;
      align-items:flex-start;
    }
    .quiz-option-index {
      width:20px;
      height:20px;
      border-radius:999px;
      border:1px solid #4b5563;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:.7rem;
      flex-shrink:0;
      margin-top:2px;
    }
    .quiz-option-text {
      flex:1;
    }
    .quiz-option.selected {
      border-color:#22c55e;
      box-shadow:0 0 0 1px rgba(34,197,94,0.6);
      background:#022c22;
    }
    .quiz-footer {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      font-size:.72rem;
    }
    .quiz-feedback {
      color:var(--text-soft);
    }
    .quiz-feedback.ok {
      color:var(--accent-soft);
    }
    .quiz-feedback.bad {
      color:#f97373;
    }
    .quiz-actions {
      display:flex;
      gap:6px;
    }

    @media (max-width:880px) {
      .layout {
        grid-template-columns:1fr;
      }
      .duo-layout {
        flex-direction:column;
      }
    }
  </style>
</head>
<body>
<div class="page">
  <h1>N√∫cleo Convocados ‚Äì Trilha estilo Duolingo + Quiz</h1>
  <div class="subtitle">
    Cada percurso representa um desafio com 10 perguntas. Atingindo pelo menos 80% de acerto,
    o ba√∫ libera a medalha da fase (Bronze, Prata, Ouro, Diamante) e o sistema registra um
    emblema de compet√™ncia (modelo Moodle). O resultado final ser√° integrado √† Gest√£o do
    Conhecimento e ao curr√≠culo inteligente.
  </div>

  <div class="top-summary">
    <div class="chip">
      <span class="label">N√∫cleo</span>
      <span class="value">Convoca√ß√µes</span>
    </div>
    <div class="chip">
      <span class="label">XP total</span>
      <span class="value" data-xp-total>0</span>
    </div>
    <div class="chip">
      <span class="label">Emblemas conquistados</span>
      <span class="value" data-emblemas-total>0</span>
    </div>
    <div class="chip">
      <span class="label">Medalha m√°xima liberada</span>
      <span class="value" data-medal-max>‚Äî</span>
    </div>
  </div>

  <div class="layout">
    <!-- ESQUERDA ‚Äì TRILHA -->
    <section class="card">
      <div class="trilha-header">
        <div>
          <div class="trilha-header-title">Trilha de desenvolvimento ‚Äì Convoca√ß√µes</div>
          <div class="trilha-header-sub">
            Caminho completo da medalha Bronze at√© a Diamante, validando compet√™ncias com testes, jogos e atividades.
          </div>
        </div>
      </div>

      <div class="duo-layout">
        <div class="duo-path" id="duoPath">
          <div class="duo-rail"></div>
          <!-- Tiers gerados via JS -->
        </div>
      </div>
    </section>

    <!-- DIREITA ‚Äì EMBLEMAS / RESUMO -->
    <section class="card">
      <div class="side-title">Emblemas Moodle conquistados nesta trilha</div>
      <div class="emblema-grid" id="emblemaGrid"></div>
      <div class="side-note">
        Cada percurso conclu√≠do libera um emblema espec√≠fico (Bronze, Prata, Ouro ou Diamante) no
        ambiente de aprendizagem. A combina√ß√£o de XP + medalhas ser√° usada para atualizar o ranking,
        a pontua√ß√£o do n√∫cleo e o cargo sugerido na jornada de carreira.
      </div>
    </section>
  </div>

  <div class="footer-note">
    Prot√≥tipo conceitual ‚Äì a l√≥gica de 80% de acerto poder√° ser alimentada com os resultados reais do Duolingo / question√°rios integrados.
  </div>
</div>

<!-- MODAL DE QUIZ -->
<div class="quiz-modal" id="quizModal">
  <div class="quiz-backdrop"></div>
  <div class="quiz-panel">
    <div class="quiz-header">
      <div>
        <div class="quiz-title" data-quiz-title>Desafio</div>
        <div class="quiz-subtitle" data-quiz-subtitle></div>
      </div>
      <button class="quiz-close" id="quizCloseBtn" title="Fechar">‚úï</button>
    </div>

    <div class="quiz-progress">
      <div class="quiz-bar">
        <div class="quiz-bar-fill" id="quizBarFill"></div>
      </div>
      <div data-quiz-counter>Pergunta 1/10</div>
    </div>

    <div class="quiz-question" data-quiz-question>
      <!-- enunciado -->
    </div>

    <div class="quiz-options" id="quizOptions">
      <!-- op√ß√µes -->
    </div>

    <div class="quiz-footer">
      <div class="quiz-feedback" id="quizFeedback"></div>
      <div class="quiz-actions">
        <button class="secondary" id="quizCancelBtn">Cancelar</button>
        <button id="quizConfirmBtn" disabled>Confirmar resposta</button>
      </div>
    </div>
  </div>
</div>

<script>
const PASS_PERCENT = 0.8;
const medalEmoji = { bronze:"ü•â", silver:"ü•à", gold:"ü•á", diamond:"üíé" };
const medalName = { bronze:"Bronze", silver:"Prata", gold:"Ouro", diamond:"Diamante" };

const trilhaConvocacoes = {
  tiers: [
    {
      id:"bronze",
      medal:"bronze",
      descricaoNivel:
        "O colaborador neste n√≠vel possui entendimento inicial sobre o m√≥dulo de Convoca√ß√µes e executa tarefas simples com base em orienta√ß√µes. Tem familiaridade com as telas e fluxos principais, mas depende de apoio para situa√ß√µes n√£o rotineiras.",
      percursos:[
        {
          id:"b1",
          titulo:"Percurso 1 ‚Äì Estrutura das tabelas b√°sicas",
          descricao:"Estrutura e utiliza√ß√£o das tabelas b√°sicas do m√≥dulo.",
          xp:20,
          questions:[
            {q:"Qual √© o objetivo principal das tabelas b√°sicas de convoca√ß√µes?", a:["Padronizar c√≥digos e par√¢metros usados nas convoca√ß√µes","Registrar apenas dados hist√≥ricos do √≥rg√£o","Substituir o cadastro de servidores","Calcular automaticamente a folha"], c:0},
            {q:"Um exemplo t√≠pico de informa√ß√£o mantida em tabela b√°sica √©:", a:["CPF do servidor","Tipo de convoca√ß√£o e sua descri√ß√£o","Justificativa individual do servidor","N√∫mero do processo administrativo"], c:1},
            {q:"Ao criar um novo tipo de convoca√ß√£o, a boa pr√°tica √©:", a:["Criar diretamente em produ√ß√£o sem testes","Reutilizar um c√≥digo existente para evitar inclus√£o","Cadastrar em ambiente de homologa√ß√£o, testar e s√≥ ent√£o levar para produ√ß√£o","Criar v√°rios tipos quase iguais para cobrir qualquer situa√ß√£o"], c:2},
            {q:"A falta de padroniza√ß√£o nas tabelas b√°sicas costuma gerar:", a:["Maior desempenho do sistema","Ambiguidade de lan√ßamentos e dificuldade de an√°lise","Redu√ß√£o de chamados de suporte","Melhor experi√™ncia do usu√°rio"], c:1},
            {q:"Quem deve autorizar altera√ß√µes estruturais em tabelas b√°sicas?", a:["Qualquer usu√°rio com acesso ao m√≥dulo","Somente o suporte t√©cnico externo","Gestor respons√°vel pelo m√≥dulo, seguindo fluxo de governan√ßa","Apenas o setor financeiro"], c:2},
            {q:"Antes de excluir um c√≥digo de tabela b√°sica √© fundamental:", a:["Apenas ocult√°-lo visualmente","Verificar se n√£o existe uso hist√≥rico ou integra√ß√µes dependentes","Excluir tamb√©m todos os registros antigos","Reiniciar o servidor"], c:1},
            {q:"Tabelas b√°sicas bem configuradas contribuem para:", a:["Aumento de retrabalho","Coer√™ncia de relat√≥rios e indicadores","Despadroniza√ß√£o de processos","Maior n√∫mero de exce√ß√µes manuais"], c:1},
            {q:"Para registrar uma nova regra de neg√≥cio associada a tipo de convoca√ß√£o, o ideal √©:", a:["Documentar a regra e vincul√°-la ao c√≥digo correspondente","Criar c√≥digos diferentes com a mesma descri√ß√£o","Alterar a regra sem registrar em lugar nenhum","Manter somente em e-mails da equipe"], c:0},
            {q:"Quando v√°rios √≥rg√£os usam o mesmo sistema, as tabelas b√°sicas devem:", a:["Ser totalmente livres, sem padr√£o comum","Seguir um modelo refer√™ncia com espa√ßo para customiza√ß√µes controladas","Ser diferentes para cada usu√°rio","Ser editadas apenas pelo fornecedor"], c:1},
            {q:"Um sintoma de tabela b√°sica mal administrada √©:", a:["Baixa taxa de chamados","Facilidade de treinamento","Listas extensas com c√≥digos redundantes e pouco claros","Ader√™ncia total √†s regras legais"], c:2}
          ]
        },
        {
          id:"b2",
          titulo:"Percurso 2 ‚Äì Minutas de convoca√ß√£o",
          descricao:"Manuten√ß√£o das minutas de convoca√ß√£o, incluindo ajustes e atualiza√ß√µes simples.",
          xp:20,
          questions:[
            {q:"A minuta de convoca√ß√£o √©:", a:["Um relat√≥rio apenas visual","O texto padr√£o usado como base para gerar as convoca√ß√µes","Um campo exclusivo do setor jur√≠dico","Um anexo opcional que n√£o impacta o processo"], c:1},
            {q:"Ao ajustar uma minuta, a preocupa√ß√£o principal deve ser:", a:["Manter a linguagem alinhada √†s regras legais e ao processo real","Usar o maior n√∫mero poss√≠vel de termos t√©cnicos","Excluir campos vari√°veis para simplificar","Personalizar apenas para um servidor espec√≠fico"], c:0},
            {q:"Campos vari√°veis em minutas (placeholders) servem para:", a:["Inserir dados automaticamente, como nome e data","Impedir edi√ß√£o manual","Ocultar informa√ß√µes sens√≠veis","Gerar n√∫meros aleat√≥rios"], c:0},
            {q:"Quando uma lei muda e altera o texto padr√£o, a a√ß√£o correta √©:", a:["Manter o texto antigo para evitar retrabalho","Atualizar a minuta, registrar a vers√£o e comunicar as √°reas impactadas","Criar uma segunda minuta sem desativar a anterior","Aguardar algu√©m reclamar para mudar"], c:1},
            {q:"Minutas duplicadas com textos ligeiramente diferentes tendem a:", a:["Melhorar a governan√ßa","Confundir usu√°rios e gerar erros","Ser ignoradas pelo sistema","Acelerar o processo"], c:1},
            {q:"Quem deve validar altera√ß√µes significativas em minutas?", a:["Apenas o desenvolvedor","Um gestor de neg√≥cio ou jur√≠dico respons√°vel","Qualquer servidor","Somente o fornecedor do sistema"], c:1},
            {q:"√â recomend√°vel registrar em algum lugar:", a:["O hist√≥rico de vers√µes das minutas","Somente a vers√£o mais recente","Apenas as minutas exclu√≠das","Nenhuma altera√ß√£o"], c:0},
            {q:"Para testes, ao alterar minutas √© boa pr√°tica:", a:["Aplicar direto em casos reais de grande impacto","Utilizar ambiente de homologa√ß√£o com casos simulados","N√£o comunicar ningu√©m","Desativar o m√≥dulo temporariamente"], c:1},
            {q:"Um erro comum em minutas √©:", a:["Uso de vari√°veis claras","Textos alinhados √† legisla√ß√£o","Informa√ß√µes contradit√≥rias com o fluxo de convoca√ß√£o","Padroniza√ß√£o de cabe√ßalhos"], c:2},
            {q:"Minutas bem estruturadas contribuem para:", a:["Redu√ß√£o de contesta√ß√µes e retrabalho","Aumento de glosas","Mais erros de digita√ß√£o","Desalinhamento com a legisla√ß√£o"], c:0}
          ]
        },
        {
          id:"b3",
          titulo:"Percurso 3 ‚Äì Tipos de convoca√ß√£o",
          descricao:"Compreens√£o geral dos tipos de convoca√ß√£o e suas finalidades.",
          xp:20,
          questions:[
            {q:"Conhecer os tipos de convoca√ß√£o √© importante para:", a:["Escolher qualquer tipo sem crit√©rio","Aplicar o tipo correto em cada cen√°rio e gerar indicadores confi√°veis","Evitar o uso do m√≥dulo","Substituir controles legais"], c:1},
            {q:"Um exemplo de tipo de convoca√ß√£o pode ser:", a:["Convoca√ß√£o para prova oral","N√∫mero do CPF","C√°lculo de f√©rias","Cadastro de dependentes"], c:0},
            {q:"Quando o usu√°rio usa tipo incorreto de convoca√ß√£o, o risco √©:", a:["Relat√≥rios distorcidos e poss√≠veis falhas legais","Melhora de performance","Apenas mudan√ßa visual","Nenhum impacto"], c:0},
            {q:"A cria√ß√£o de novos tipos deve considerar:", a:["Regra de neg√≥cio, impacto legal e necessidade real","Somente prefer√™ncias pessoais","Apenas o layout da tela","Qualquer sugest√£o sem an√°lise"], c:0},
            {q:"Tipos raramente usados devem:", a:["Permanecer ativos sem an√°lise","Ser avaliados para poss√≠vel desativa√ß√£o ou agrupamento","Ser duplicados","Ser renomeados sem crit√©rio"], c:1},
            {q:"Para treinamento, √© √∫til relacionar tipos de convoca√ß√£o com:", a:["Casos pr√°ticos do √≥rg√£o","Temas aleat√≥rios","Somente teoria jur√≠dica","Apenas fluxogramas gen√©ricos"], c:0},
            {q:"A documenta√ß√£o dos tipos de convoca√ß√£o deve incluir:", a:["Descri√ß√£o, quando usar, exemplos e respons√°veis pela regra","Somente o c√≥digo num√©rico","Apenas a data de cria√ß√£o","Nome de quem cadastrou"], c:0},
            {q:"Tipos diferentes com o mesmo significado tendem a:", a:["Simplificar o uso","Gerar confus√£o e erros de classifica√ß√£o","Melhorar relat√≥rios","Facilitar suporte"], c:1},
            {q:"Para auditoria, √© √∫til que o sistema:", a:["N√£o registre quem usou cada tipo","Registre uso hist√≥rico por tipo de convoca√ß√£o","Apague dados antigos","Permita altera√ß√£o retroativa sem log"], c:1},
            {q:"Quando h√° d√∫vida sobre qual tipo usar, o operador deve:", a:["Escolher qualquer um e seguir","Consultar orienta√ß√£o formal ou manual do m√≥dulo","Parar de usar o sistema","Criar um tipo novo por conta pr√≥pria"], c:1}
          ]
        }
      ]
    },
    {
      id:"prata",
      medal:"silver",
      descricaoNivel:
        "Profissional com dom√≠nio das rotinas operacionais e boa compreens√£o do processo completo de convoca√ß√£o. Atua com autonomia nas atividades di√°rias e entende como o m√≥dulo se conecta a outros componentes do sistema.",
      percursos:[
        {
          id:"p1",
          titulo:"Percurso 4 ‚Äì Confer√™ncia da quota",
          descricao:"Confer√™ncia e valida√ß√£o da planilha de quota, assegurando consist√™ncia nas informa√ß√µes.",
          xp:25,
          questions:[
            {q:"Na confer√™ncia da quota, um ponto cr√≠tico √©:", a:["Conferir apenas o total global","Validar se a distribui√ß√£o por servidor segue as regras definidas","Ignorar diferen√ßas pequenas","Desconsiderar integra√ß√µes"], c:1},
            {q:"Inconsist√™ncias na quota costumam indicar:", a:["Uso correto de tipos de convoca√ß√£o","Problemas em par√¢metros, regras ou dados de origem","Melhoria de performance","Aus√™ncia de regras"], c:1},
            {q:"√â importante comparar a planilha de quota com:", a:["Apenas o hist√≥rico anterior","Fontes oficiais de refer√™ncia e legisla√ß√£o aplic√°vel","Not√≠cias de jornal","Dados n√£o estruturados"], c:1},
            {q:"Durante a confer√™ncia, diverg√™ncias relevantes devem ser:", a:["Corrigidas sem registro","Registradas, analisadas e tratadas em fluxo pr√≥prio","Ignoradas se o prazo for curto","Apenas comunicadas verbalmente"], c:1},
            {q:"A responsabilidade pela confer√™ncia formal √©, em geral:", a:["Do usu√°rio qualquer","De √°rea designada (ex.: RH/Planejamento) com pap√©is definidos","Somente da TI","De um estagi√°rio"], c:1},
            {q:"Um bom controle de vers√£o da quota permite:", a:["Rastrear de onde surgiu cada altera√ß√£o","Evitar qualquer hist√≥rico","Editar sem seguran√ßa","Confundir auditores"], c:0},
            {q:"Erros de quota n√£o detectados podem gerar:", a:["Maior confian√ßa do servidor","Processos administrativos, glosas ou passivos","Redu√ß√£o de risco","Nenhuma consequ√™ncia"], c:1},
            {q:"A checagem cruzada da quota com outros m√≥dulos (ex.: folha) ajuda a:", a:["Replicar inconsist√™ncias","Detectar diverg√™ncias antes de executar convoca√ß√µes","Aumentar a complexidade sem ganho","Substituir auditoria"], c:1},
            {q:"Na pr√°tica, √© √∫til usar:", a:["Planilhas sem crit√©rios","Checklists e relat√≥rios padr√£o de confer√™ncia","Anota√ß√µes dispersas","Somente mem√≥ria da equipe"], c:1},
            {q:"Quem identifica erro de quota deve:", a:["Seguir procedimento formal de registro e corre√ß√£o","Apenas ajustar manualmente e seguir","Ignorar para n√£o atrasar","Apagar registros antigos"], c:0}
          ]
        },
        {
          id:"p2",
          titulo:"Percurso 5 ‚Äì Uso do quadro de convoca√ß√µes",
          descricao:"Utiliza√ß√£o eficiente da tela de quadro de convoca√ß√µes, com entendimento de filtros e indicadores.",
          xp:25,
          questions:[
            {q:"O quadro de convoca√ß√µes serve para:", a:["Exibir apenas um registro por vez","Visualizar e gerir o conjunto de convoca√ß√µes com filtros e indicadores","Substituir relat√≥rios oficiais","Lan√ßar dados financeiros"], c:1},
            {q:"Filtros bem usados permitem:", a:["Esconder informa√ß√µes importantes","Focar em grupos espec√≠ficos de convoca√ß√µes para an√°lise e a√ß√£o","Aumentar o tempo de trabalho","Desorganizar a tela"], c:1},
            {q:"Um exemplo de filtro √∫til √©:", a:["Cor favorita do usu√°rio","Situa√ß√£o da convoca√ß√£o (pendente, conclu√≠da, cancelada)","Tipo de monitor usado","Marca do teclado"], c:1},
            {q:"Indicadores no quadro, como quantidade por status, ajudam a:", a:["Entender gargalos e priorizar a√ß√µes","Complicar a visibilidade","Substituir toda a gest√£o","Gerar ru√≠do"], c:0},
            {q:"Para acompanhamento di√°rio, √© recomendado:", a:["N√£o usar filtros","Ter vis√µes padr√£o salvas para perfis diferentes de usu√°rio","Atualizar manualmente toda vez","Depender apenas de planilhas externas"], c:1},
            {q:"A combina√ß√£o de filtros de data e tipo de convoca√ß√£o √© √∫til para:", a:["Analisar s√©ries hist√≥ricas e picos de demanda","Zerar a base de dados","Esconder falhas","Evitar registros"], c:0},
            {q:"Uma boa pr√°tica √© registrar:", a:["Quem alterou status relevantes diretamente pelo quadro","Apenas quem visualizou a tela","Somente o IP da m√°quina","Nada"], c:0},
            {q:"Se o quadro estiver muito lento, uma primeira a√ß√£o √©:", a:["Aumentar ainda mais a quantidade de registros por p√°gina","Rever filtros, √≠ndices e condi√ß√µes de busca","Excluir convoca√ß√µes antigas sem crit√©rio","Trocar a cor da interface"], c:1},
            {q:"Treinar usu√°rios no uso do quadro reduz:", a:["Depend√™ncia de relat√≥rios paralelos e consultas ao suporte","Capacidade de an√°lise","Visibilidade da situa√ß√£o","Padroniza√ß√£o"], c:0},
            {q:"Um quadro bem configurado √© pe√ßa chave para:", a:["Gest√£o visual do processo de convoca√ß√µes","Impedir auditorias","Reduzir transpar√™ncia","Desconectar m√≥dulos"], c:0}
          ]
        },
        {
          id:"p3",
          titulo:"Percurso 6 ‚Äì Regras b√°sicas aplicadas",
          descricao:"Aplica√ß√£o correta das regras b√°sicas dos processos de convoca√ß√£o.",
          xp:25,
          questions:[
            {q:"Regras b√°sicas de convoca√ß√£o incluem:", a:["Fluxos, prazos, crit√©rios de sele√ß√£o e bases legais","Prefer√™ncias pessoais do operador","Somente layout de tela","Cor do √≠cone"], c:0},
            {q:"Aplicar regra errada em um caso gera:", a:["Maior seguran√ßa jur√≠dica","Risco de contesta√ß√£o ou nulidade do processo","Apenas demora","Nenhum impacto"], c:1},
            {q:"√â importante que as regras estejam:", a:["Apenas na cabe√ßa do gestor","Formalmente documentadas e alinhadas ao sistema","Somente em e-mails antigos","Em bilhetes manuais"], c:1},
            {q:"A parametriza√ß√£o do sistema deve refletir:", a:["As regras operacionais e legais vigentes","Somente a conveni√™ncia do desenvolvedor","Regras de outro √≥rg√£o sem avalia√ß√£o","Prefer√™ncias tempor√°rias"], c:0},
            {q:"Quando h√° exce√ß√£o √† regra, o ideal √©:", a:["Lan√ßar como se fosse caso normal","Registrar a exce√ß√£o, o motivo e aprova√ß√£o competente","N√£o registrar nada","Criar tipo novo sem an√°lise"], c:1},
            {q:"Treinamentos de regras b√°sicas s√£o mais efetivos quando:", a:["Usam apenas teoria","Mesclam exemplos reais, exerc√≠cios e simula√ß√µes no sistema","Ocorrem uma √∫nica vez","S√£o opcionais"], c:1},
            {q:"Regras bem aplicadas apoiam:", a:["Transpar√™ncia, previsibilidade e equidade","Confus√£o de crit√©rios","Aumento de retrabalho","Redu√ß√£o de seguran√ßa"], c:0},
            {q:"Atualiza√ß√µes de regra devem ser:", a:["Informais e pontuais","Comunicadas, registradas e refletidas em manuais e parametriza√ß√µes","Feitas apenas em planilhas pessoais","Evitas"], c:1},
            {q:"Uma boa pr√°tica √© associar regras a:", a:["Indicadores que mostrem ader√™ncia e desvios","Nenhum tipo de medi√ß√£o","Somente percep√ß√£o do gestor","Sorteio"], c:0},
            {q:"Quando o sistema n√£o permite aplicar a regra corretamente, deve-se:", a:["For√ßar lan√ßamentos errados","Registrar o problema e acionar equipe respons√°vel para ajuste","Ignorar a regra","Usar atalhos n√£o oficiais"], c:1}
          ]
        }
      ]
    },
    {
      id:"ouro",
      medal:"gold",
      descricaoNivel:
        "Profissional com dom√≠nio t√©cnico e funcional do m√≥dulo, capaz de diagnosticar e corrigir falhas complexas. Entende a fundo as regras de neg√≥cio e o comportamento do sistema em diferentes cen√°rios.",
      percursos:[
        {
          id:"o1",
          titulo:"Percurso 7 ‚Äì C√≥digo de c√°lculo",
          descricao:"Interpreta√ß√£o do c√≥digo da f√≥rmula de c√°lculo das convoca√ß√µes e valida√ß√£o de resultados.",
          xp:30,
          questions:[
            {q:"Conhecer a f√≥rmula de c√°lculo permite:", a:["Apenas decorar n√∫meros","Entender como cada par√¢metro influencia o resultado","Impedir melhorias","Substituir testes"], c:1},
            {q:"Ao revisar um resultado suspeito, o analista deve:", a:["Assumir que o sistema est√° certo","Reproduzir o c√°lculo passo a passo com base na f√≥rmula e nos dados de entrada","Ignorar o caso","Alterar manualmente sem registro"], c:1},
            {q:"Coment√°rios no c√≥digo ou na documenta√ß√£o servem para:", a:["Registrar l√≥gica e premissas da f√≥rmula","Deixar o c√≥digo mais lento","Confundir leitores","Substituir testes"], c:0},
            {q:"Quando uma regra muda por lei, o c√°lculo deve:", a:["Permanecer igual","Ser ajustado, testado e versionado com clareza","Ser alterado apenas em planilha externa","Ser ocultado dos usu√°rios"], c:1},
            {q:"Testes de c√°lculo devem contemplar:", a:["Somente casos simples","Cen√°rios t√≠picos, limites e exce√ß√µes","Apenas um exemplo","Nenhum hist√≥rico"], c:1},
            {q:"Registrar casos de teste aprovados ajuda a:", a:["Repetir erros","Facilitar retestes ap√≥s mudan√ßa","Confundir auditores","Reduzir rastreabilidade"], c:1},
            {q:"Quando h√° diverg√™ncia entre sistema e planilha do usu√°rio, √© importante:", a:["Assumir que a planilha est√° correta","Comparar par√¢metros, f√≥rmula e base de dados dos dois lados","Ignorar a diferen√ßa","Refazer tudo descrevendo outra regra"], c:1},
            {q:"Documentar as vari√°veis usadas na f√≥rmula ajuda:", a:["Somente programadores","Toda a cadeia de neg√≥cio a entender o c√°lculo","Ningu√©m","A complicar o processo"], c:1},
            {q:"Um bom desenho de c√°lculo inclui:", a:["Entradas, processamento, sa√≠das e exemplos","Apenas uma tabela est√°tica","Somente c√≥digo-fonte","Apenas descri√ß√£o jur√≠dica"], c:0},
            {q:"Erros de c√°lculo n√£o tratados podem gerar:", a:["Maior confian√ßa","Passivos financeiros e contesta√ß√µes","Nenhum impacto","Somente melhorias"], c:1}
          ]
        },
        {
          id:"o2",
          titulo:"Percurso 8 ‚Äì Tratamentos manuais",
          descricao:"Execu√ß√£o de tratamentos manuais e convoca√ß√µes corretivas, garantindo integridade dos dados.",
          xp:30,
          questions:[
            {q:"Tratamentos manuais devem ser usados:", a:["Como regra principal","Somente em situa√ß√µes excepcionais e controladas","Sempre que for mais r√°pido","Para substituir regras"], c:1},
            {q:"Cada tratamento manual precisa de:", a:["Registro de motivo, respons√°vel e evid√™ncias","Nenhuma explica√ß√£o","Somente um coment√°rio gen√©rico","Aprova√ß√£o verbal"], c:0},
            {q:"Se a equipe usa tratamentos manuais frequentes, isso indica:", a:["Regras bem definidas","Problemas de parametriza√ß√£o ou processo","Total ader√™ncia","Melhor uso do sistema"], c:1},
            {q:"Uma boa pr√°tica √© criar:", a:["Relat√≥rios sobre volume e tipo de tratamentos manuais","Tratamentos sem registro","Apenas anota√ß√µes pessoais","Fluxos n√£o oficiais"], c:0},
            {q:"Para reduzir tratamentos manuais, precisa-se:", a:["Ignorar exce√ß√µes","Analisar causas-raiz e ajustar regras ou integra√ß√µes","Culpar usu√°rios","Aumentar n√∫mero de cliques"], c:1},
            {q:"Tratamento corretivo sem rastreabilidade pode gerar:", a:["Maior transpar√™ncia","Dificuldade de auditoria e d√∫vidas sobre integridade","Melhor governan√ßa","Nenhum risco"], c:1},
            {q:"Quem aprova tratamentos sens√≠veis deve ser:", a:["Qualquer operador","Gestor definido com perfil adequado","Um usu√°rio aleat√≥rio","Ningu√©m"], c:1},
            {q:"Ferramentas visuais de acompanhamento ajudam a:", a:["Esconder problemas","Identificar padr√µes de uso de tratamentos manuais","Complicar a gest√£o","Reduzir indicadores"], c:1},
            {q:"Documentar li√ß√µes aprendidas de casos complexos permite:", a:["Repetir erros","Usar os casos como material de treinamento","Esquecer rapidamente","Desconectar processos"], c:1},
            {q:"A automa√ß√£o de etapas recorrentes de tratamento manual deve:", a:["Ser evitada","Ser avaliada para incorpora√ß√£o como regra oficial","Ser feita sem valida√ß√£o","Substituir toda checagem"], c:1}
          ]
        },
        {
          id:"o3",
          titulo:"Percurso 9 ‚Äì Revers√£o de convoca√ß√µes",
          descricao:"Revers√£o de processos de convoca√ß√£o, avaliando seus impactos em outros m√≥dulos.",
          xp:30,
          questions:[
            {q:"Reverter convoca√ß√£o significa:", a:["Apagar todo hist√≥rico","Anular ou corrigir lan√ßamento mantendo rastreabilidade","Ignorar o caso","Refazer tudo sem registro"], c:1},
            {q:"Antes de reverter, √© fundamental:", a:["N√£o analisar impacto","Avaliar integra√ß√µes com outros m√≥dulos (vagas, folha, tempo de servi√ßo etc.)","Apenas perguntar ao colega","Desativar o m√≥dulo"], c:1},
            {q:"Um bom processo de revers√£o inclui:", a:["Motivo, data, respons√°vel e refer√™ncia ao registro original","Somente apagar dados","Alterar campos sem log","Uso de senha gen√©rica"], c:0},
            {q:"Revers√µes em massa exigem:", a:["Nenhum controle especial","Planejamento, testes e aprova√ß√£o formal","Execu√ß√£o direta em produ√ß√£o","Somente e-mail informal"], c:1},
            {q:"Ap√≥s reverter, recomenda-se:", a:["N√£o verificar mais nada","Conferir relat√≥rios e indicadores afetados","Apagar logs","Ignorar usu√°rios"], c:1},
            {q:"Se revers√µes s√£o muito frequentes, isso pode indicar:", a:["Regras bem definidas","Problemas em processos ou treinamentos","Alta maturidade","Excel√™ncia absoluta"], c:1},
            {q:"O sistema deve impedir:", a:["Qualquer revers√£o","Revers√µes sem registro m√≠nimo de justificativa","Registro de justificativa","Auditoria"], c:1},
            {q:"Fluxos de autoriza√ß√£o diferenciados para revers√£o ajudam a:", a:["Reduzir seguran√ßa","Garantir que apenas perfis adequados executem a√ß√µes sens√≠veis","Complicar sem motivo","Dispensar registros"], c:1},
            {q:"Para fins de auditoria, revers√µes cr√≠ticas devem ser:", a:["An√¥nimas","Relatadas em pain√©is espec√≠ficos","Omitidas","Editadas depois"], c:1},
            {q:"Revers√£o bem gerida contribui para:", a:["Integridade e confian√ßa nos dados","Aumento de erros ocultos","Perda de hist√≥rico","Descontrole"], c:0}
          ]
        }
      ]
    },
    {
      id:"diamante",
      medal:"diamond",
      descricaoNivel:
        "√â a principal refer√™ncia t√©cnica e funcional do m√≥dulo, com dom√≠nio total sobre regras, c√°lculos e integra√ß√µes. Atua de forma estrat√©gica, apoiando decis√µes, revisando processos e promovendo a melhoria cont√≠nua do uso do sistema.",
      percursos:[
        {
          id:"d1",
          titulo:"Percurso 10 ‚Äì Vis√£o integrada do m√≥dulo",
          descricao:"Vis√£o completa e integrada do m√≥dulo e de suas intera√ß√µes com outros componentes do sistema.",
          xp:35,
          questions:[
            {q:"Vis√£o integrada significa:", a:["Olhar apenas para a tela atual","Entender como o m√≥dulo se relaciona com outros processos e sistemas","Ignorar integra√ß√µes","Focar s√≥ em tecnologia"], c:1},
            {q:"Um exemplo de integra√ß√£o importante √©:", a:["Convoca√ß√µes x Controle de Vagas","Convoca√ß√µes x Cor do monitor","Convoca√ß√µes x Papel da impressora","Convoca√ß√µes x Clima"], c:0},
            {q:"Mapear integra√ß√µes ajuda a:", a:["Descobrir onde decis√µes de um m√≥dulo impactam outro","Complicar sem ganho","Dispensar testes","Ocultar falhas"], c:0},
            {q:"Documentos de arquitetura devem registrar:", a:["Apenas nomes das telas","Fluxos, integra√ß√µes, pontos de entrada e sa√≠da","Somente regras jur√≠dicas","Nada"], c:1},
            {q:"Em projetos de mudan√ßa, √© essencial:", a:["Avaliar impacto apenas local","Avaliar impactos sist√™micos, inclusive em relat√≥rios e indicadores","Pensar s√≥ em prazos","Desconsiderar integra√ß√µes"], c:1},
            {q:"Reuni√µes inter√°reas sobre o m√≥dulo ajudam a:", a:["Criar conflitos","Alinhar expectativas, restri√ß√µes e oportunidades","Prejudicar comunica√ß√£o","Isolar times"], c:1},
            {q:"Vis√£o integrada apoia decis√µes de:", a:["Curto prazo apenas","Gest√£o estrat√©gica de pessoas, vagas e or√ßamentos","Marketing externo","TI isolada"], c:1},
            {q:"Pontos de integra√ß√£o cr√≠ticos deveriam ter:", a:["Nenhum monitoramento","Indicadores e alertas espec√≠ficos","Apenas e-mails","Logs ocultos"], c:1},
            {q:"Quando h√° incidente em outro m√≥dulo, o especialista de convoca√ß√µes deve:", a:["Ignorar","Avaliar se h√° rela√ß√£o com regras de convoca√ß√£o","Desativar o sistema","Culpar usu√°rios"], c:1},
            {q:"Vis√£o integrada √© caracter√≠stica de:", a:["Usu√°rio iniciante","Especialista de refer√™ncia no m√≥dulo","Quem n√£o conhece o processo","Somente desenvolvedores"], c:1}
          ]
        },
        {
          id:"d2",
          titulo:"Percurso 11 ‚Äì Padr√µes e parametriza√ß√µes",
          descricao:"Capacidade de definir padr√µes, revisar regras e validar parametriza√ß√µes.",
          xp:35,
          questions:[
            {q:"Definir padr√µes significa:", a:["Deixar cada um usar como quiser","Estabelecer formas consistentes de uso, nomes e regras","Despadronizar","Trabalhar sem crit√©rio"], c:1},
            {q:"Parametriza√ß√µes mal geridas levam a:", a:["Processos robustos","Comportamentos inconsistentes do sistema","Maior governan√ßa","Redu√ß√£o de riscos"], c:1},
            {q:"Revisar regras periodicamente √© importante porque:", a:["As leis e processos mudam ao longo do tempo","Nada nunca muda","Complica o trabalho","√â in√∫til"], c:0},
            {q:"Toda parametriza√ß√£o relevante deve ter:", a:["Registro de quem decidiu, motivo e data","Apenas valor atual","Segredo absoluto","Controle informal"], c:0},
            {q:"Ambiente de testes √© usado para:", a:["Alterar direto em produ√ß√£o","Validar parametriza√ß√µes antes de aplicar em produ√ß√£o","Armazenar dados aleat√≥rios","Dispensar homologa√ß√£o"], c:1},
            {q:"Checklists de parametriza√ß√£o ajudam a:", a:["Garantir que pontos cr√≠ticos sejam sempre avaliados","Aumentar riscos","Confundir equipe","Reduzir transpar√™ncia"], c:0},
            {q:"Padr√µes devem ser:", a:["Totalmente r√≠gidos sem exce√ß√£o","Flex√≠veis, mas com crit√©rios claros para exce√ß√µes","Ignorados","Secretos"], c:1},
            {q:"Treinar a equipe nos padr√µes definidos evita:", a:["Uso incorreto e m√∫ltiplas vers√µes de verdade","Ado√ß√£o do modelo","Padroniza√ß√£o","Governan√ßa"], c:0},
            {q:"Parametriza√ß√µes alinhadas ao planejamento estrat√©gico permitem:", a:["Que o sistema reforce as prioridades da organiza√ß√£o","Aumento de inconsist√™ncias","Descolamento do neg√≥cio","Somente est√©tica"], c:0},
            {q:"O papel do especialista √©:", a:["Apenas executar tarefas","Conduzir revis√£o de padr√µes, ouvir √°reas e propor melhorias","Trabalhar isolado","Ignorar feedbacks"], c:1}
          ]
        },
        {
          id:"d3",
          titulo:"Percurso 12 ‚Äì Apoio estrat√©gico",
          descricao:"Apoio estrat√©gico a outras √°reas e coordena√ß√£o de capacita√ß√µes internas; responsabilidade pela excel√™ncia do m√≥dulo.",
          xp:35,
          questions:[
            {q:"Apoio estrat√©gico significa:", a:["Responder d√∫vidas pontuais apenas","Usar conhecimento do m√≥dulo para apoiar decis√µes de alto impacto","Fazer tarefas b√°sicas","Evitar participa√ß√£o em f√≥runs"], c:1},
            {q:"Um especialista estrat√©gico deve:", a:["Entender s√≥ a tecnologia","Conhecer regras, contexto institucional e indicadores","Focar apenas em relat√≥rios t√©cnicos","Ignorar planejamento"], c:1},
            {q:"Capacita√ß√µes internas bem planejadas geram:", a:["Depend√™ncia maior do especialista","Autonomia da equipe e redu√ß√£o de erros","Aumento de retrabalho","Nenhuma mudan√ßa"], c:1},
            {q:"Participar de comit√™s e f√≥runs de decis√£o ajuda o especialista a:", a:["Entender prioridades e antecipar ajustes no m√≥dulo","Isolar-se","Complicar fluxos","Perder vis√£o sist√™mica"], c:0},
            {q:"Um indicador relevante para atua√ß√£o estrat√©gica √©:", a:["Quantidade de cliques na tela","Impacto do m√≥dulo em resultados-chave (SLA, glosa, satisfa√ß√£o etc.)","Cor do bot√£o","N√∫mero de usu√°rios logados"], c:1},
            {q:"A vis√£o de melhoria cont√≠nua envolve:", a:["Manter tudo como est√°","Planejar, testar, medir e ajustar mudan√ßas","Mudar sem medir","Apenas reagir a crises"], c:1},
            {q:"O especialista estrat√©gico deve estimular:", a:["Uso improvisado do sistema","Registro de boas pr√°ticas, li√ß√µes aprendidas e inova√ß√µes","Falta de documenta√ß√£o","Centraliza√ß√£o de conhecimento"], c:1},
            {q:"Quando identifica oportunidade de inova√ß√£o, o especialista pode:", a:["Ignorar e focar no dia a dia","Estruturar proposta, estimar ganhos e levar ao comit√™ adequado","Apenas comentar informalmente","Mudar silenciosamente"], c:1},
            {q:"Na cultura de excel√™ncia, o m√≥dulo de Convoca√ß√µes √© visto como:", a:["Apenas uma obriga√ß√£o","Ferramenta cr√≠tica de gest√£o de pessoas e riscos","Algo isolado","Somente software"], c:1},
            {q:"Ser refer√™ncia estrat√©gica significa:", a:["Ser o √∫nico que sabe usar o sistema","Influenciar positivamente processos, aprendizagem e resultados","Evitar compartilhamento de conhecimento","Fugir de responsabilidades"], c:1}
          ]
        }
      ]
    }
  ]
};

const state = {
  completed: {} // idPercurso -> {score, xp}
};

let currentQuiz = null;

const duoPath = document.getElementById("duoPath");
const xpTotalEl = document.querySelector("[data-xp-total]");
const emblemasTotalEl = document.querySelector("[data-emblemas-total]");
const medalMaxEl = document.querySelector("[data-medal-max]");
const emblemaGrid = document.getElementById("emblemaGrid");

const quizModal = document.getElementById("quizModal");
const quizTitleEl = document.querySelector("[data-quiz-title]");
const quizSubtitleEl = document.querySelector("[data-quiz-subtitle]");
const quizCounterEl = document.querySelector("[data-quiz-counter]");
const quizQuestionEl = document.querySelector("[data-quiz-question]");
const quizOptionsEl = document.getElementById("quizOptions");
const quizBarFill = document.getElementById("quizBarFill");
const quizFeedback = document.getElementById("quizFeedback");
const quizConfirmBtn = document.getElementById("quizConfirmBtn");
const quizCancelBtn = document.getElementById("quizCancelBtn");
const quizCloseBtn = document.getElementById("quizCloseBtn");

quizCancelBtn.addEventListener("click", () => closeQuiz(true));
quizCloseBtn.addEventListener("click", () => closeQuiz(true));

quizConfirmBtn.addEventListener("click", () => {
  if (!currentQuiz) return;
  const q = currentQuiz.questions[currentQuiz.index];
  if (currentQuiz.selectedIndex == null) return;

  const correct = currentQuiz.selectedIndex === q.c;
  if (correct) currentQuiz.correct++;

  quizFeedback.classList.remove("ok","bad");
  quizFeedback.classList.add(correct ? "ok" : "bad");
  quizFeedback.textContent = correct ? "Resposta correta! Vamos para a pr√≥xima quest√£o." :
                                       "Resposta incorreta. A pr√≥xima quest√£o j√° considera essa aprendizagem.";

  currentQuiz.index++;
  currentQuiz.selectedIndex = null;

  if (currentQuiz.index >= currentQuiz.questions.length) {
    finishQuiz();
  } else {
    setTimeout(() => {
      quizFeedback.textContent = "";
      renderQuizQuestion();
    }, 600);
  }
});

function isTierUnlocked(tierIndex) {
  if (tierIndex === 0) return true;
  const prevTier = trilhaConvocacoes.tiers[tierIndex - 1];
  return prevTier.percursos.every(p => state.completed[p.id]);
}

function isPercursoUnlocked(tierIndex, percursoIndex) {
  if (!isTierUnlocked(tierIndex)) return false;
  if (percursoIndex === 0) return true;
  const tier = trilhaConvocacoes.tiers[tierIndex];
  const prev = tier.percursos[percursoIndex - 1];
  return !!state.completed[prev.id];
}

function renderPath() {
  duoPath.innerHTML = '<div class="duo-rail"></div>';

  trilhaConvocacoes.tiers.forEach((tier, tierIndex) => {
    const tierBlock = document.createElement("div");
    tierBlock.className = "tier-block";
    tierBlock.dataset.tier = tier.id;

    const heading = document.createElement("div");
    heading.className = "tier-heading";

    const pill = document.createElement("div");
    pill.className = "medal-pill " + tier.medal;
    const iconSpan = document.createElement("span");
    iconSpan.className = "icon";
    iconSpan.textContent = medalEmoji[tier.medal];
    const textSpan = document.createElement("span");
    textSpan.textContent = "Medalha " + medalName[tier.medal];

    pill.appendChild(iconSpan);
    pill.appendChild(textSpan);

    const descWrap = document.createElement("div");
    descWrap.style.flex = "1";

    const tierDesc = document.createElement("div");
    tierDesc.className = "tier-desc";
    tierDesc.textContent = tier.descricaoNivel;

    const lockInfo = document.createElement("div");
    lockInfo.className = "tier-lock";
    const unlocked = isTierUnlocked(tierIndex);
    lockInfo.innerHTML = unlocked
      ? "üîì N√≠vel liberado ‚Äì conclua os percursos para consolidar a medalha."
      : "üîí N√≠vel bloqueado ‚Äì conclua todos os percursos da medalha anterior para avan√ßar.";

    descWrap.appendChild(tierDesc);
    descWrap.appendChild(lockInfo);

    heading.appendChild(pill);
    heading.appendChild(descWrap);

    const bau = document.createElement("div");
    bau.className = "bau " + (isTierCompleted(tier) ? "open" : "locked");
    bau.innerHTML = isTierCompleted(tier) ? "üß∞" : "üì¶";
    bau.title = isTierCompleted(tier)
      ? "Ba√∫ aberto ‚Äì medalha consolidada."
      : "Ba√∫ trancado ‚Äì conclua todos os percursos com nota ‚â• 80%.";

    tierBlock.appendChild(heading);
    tierBlock.appendChild(bau);

    tier.percursos.forEach((p, idx) => {
      const percurso = document.createElement("div");
      percurso.className = "percurso";

      const node = document.createElement("div");
      node.className = "percurso-node";
      node.dataset.percursoId = p.id;
      node.textContent = idx + 1;

      const available = isPercursoUnlocked(tierIndex, idx);
      const completed = !!state.completed[p.id];

      if (!available) node.classList.add("locked");
      if (completed) node.classList.add("completed");

      const line = document.createElement("div");
      line.className = "percurso-line";

      const card = document.createElement("div");
      card.className = "percurso-card";

      const title = document.createElement("div");
      title.className = "percurso-title";
      title.textContent = p.titulo;

      const detail = document.createElement("div");
      detail.className = "percurso-detail";
      detail.textContent = p.descricao;

      const meta = document.createElement("div");
      meta.className = "percurso-meta";
      meta.textContent = `Desafio com ${p.questions.length} perguntas ¬∑ Necess√°rio acerto m√≠nimo de 80% (8/10).`;

      const actions = document.createElement("div");
      actions.className = "percurso-actions";

      const status = document.createElement("div");
      status.className = "status-label";
      if (completed) {
        const s = state.completed[p.id];
        status.classList.add("ok");
        status.textContent = `Aprovado ‚Äì ${s.score}/${p.questions.length} (${s.score * 10}%) ¬∑ XP +${p.xp}`;
      } else if (!available) {
        status.textContent = "Aguardando percurso anterior.";
      } else {
        status.textContent = "Pendente.";
      }

      const btn = document.createElement("button");
      btn.innerHTML = "Iniciar desafio";
      btn.disabled = !available || completed;
      btn.addEventListener("click", () => {
        openQuiz(tier, p);
      });

      const resetBtn = document.createElement("button");
      resetBtn.textContent = "Reset";
      resetBtn.className = "secondary";
      resetBtn.disabled = !completed;
      resetBtn.addEventListener("click", () => {
        delete state.completed[p.id];
        updateAll();
      });

      actions.appendChild(status);
      actions.appendChild(btn);
      actions.appendChild(resetBtn);

      card.appendChild(title);
      card.appendChild(detail);
      card.appendChild(meta);
      card.appendChild(actions);

      percurso.appendChild(node);
      percurso.appendChild(line);
      percurso.appendChild(card);

      tierBlock.appendChild(percurso);
    });

    duoPath.appendChild(tierBlock);
  });
}

function isTierCompleted(tier) {
  return tier.percursos.every(p => state.completed[p.id]);
}

function openQuiz(tier, percurso) {
  currentQuiz = {
    tierId: tier.id,
    medal: tier.medal,
    percursoId: percurso.id,
    titulo: percurso.titulo,
    descricao: percurso.descricao,
    questions: percurso.questions,
    index: 0,
    correct: 0,
    selectedIndex: null
  };
  quizTitleEl.textContent = `${percurso.titulo} (${medalName[tier.medal]})`;
  quizSubtitleEl.textContent = percurso.descricao;
  quizFeedback.textContent = "";
  quizFeedback.className = "quiz-feedback";
  quizConfirmBtn.disabled = true;
  renderQuizQuestion();
  quizModal.classList.add("active");
}

function renderQuizQuestion() {
  const q = currentQuiz.questions[currentQuiz.index];
  const total = currentQuiz.questions.length;
  quizCounterEl.textContent = `Pergunta ${currentQuiz.index + 1}/${total}`;
  quizBarFill.style.width = `${((currentQuiz.index) / total) * 100}%`;
  quizQuestionEl.textContent = q.q;
  quizOptionsEl.innerHTML = "";
  quizConfirmBtn.disabled = true;

  q.a.forEach((text, idx) => {
    const opt = document.createElement("div");
    opt.className = "quiz-option";
    opt.dataset.index = idx;
    const indexSpan = document.createElement("div");
    indexSpan.className = "quiz-option-index";
    indexSpan.textContent = String.fromCharCode(65 + idx);
    const textSpan = document.createElement("div");
    textSpan.className = "quiz-option-text";
    textSpan.textContent = text;
    opt.appendChild(indexSpan);
    opt.appendChild(textSpan);
    opt.addEventListener("click", () => {
      currentQuiz.selectedIndex = idx;
      Array.from(quizOptionsEl.children).forEach(o => o.classList.remove("selected"));
      opt.classList.add("selected");
      quizConfirmBtn.disabled = false;
    });
    quizOptionsEl.appendChild(opt);
  });
}

function finishQuiz() {
  const total = currentQuiz.questions.length;
  const score = currentQuiz.correct;
  const percent = score / total;
  const approved = percent >= PASS_PERCENT;

  quizBarFill.style.width = "100%";

  quizFeedback.classList.remove("bad","ok");
  quizFeedback.classList.add(approved ? "ok" : "bad");
  quizFeedback.textContent = approved
    ? `Parab√©ns! Voc√™ acertou ${score}/${total} (${score * 10}%). Compet√™ncia validada para este percurso.`
    : `Voc√™ acertou ${score}/${total} (${score * 10}%). √â necess√°rio ao menos 8 acertos para validar este percurso.`;

  quizConfirmBtn.disabled = true;
  quizCancelBtn.textContent = "Fechar";

  if (approved) {
    // atribuir XP do percurso correspondente
    const tier = trilhaConvocacoes.tiers.find(t => t.id === currentQuiz.tierId);
    const percurso = tier.percursos.find(p => p.id === currentQuiz.percursoId);
    state.completed[currentQuiz.percursoId] = {score, xp:percurso.xp};
  }

  setTimeout(() => {
    closeQuiz(false);
  }, 1000);
}

function closeQuiz(cancelOnly) {
  quizModal.classList.remove("active");
  currentQuiz = null;
  quizCancelBtn.textContent = "Cancelar";
  if (!cancelOnly) {
    updateAll();
  } else {
    updateAll(); // mesmo cancelando, atualiza tela (nenhuma mudan√ßa se n√£o aprovou)
  }
}

function updateSummary() {
  let totalXp = 0;
  let emblemas = 0;
  Object.values(state.completed).forEach(c => {
    totalXp += c.xp;
    emblemas += 1;
  });

  xpTotalEl.textContent = totalXp;
  emblemasTotalEl.textContent = emblemas;

  let highestMedal = null;
  trilhaConvocacoes.tiers.forEach(tier => {
    if (isTierCompleted(tier)) highestMedal = tier.medal;
  });
  medalMaxEl.textContent = highestMedal ? `Medalha ${medalName[highestMedal]}` : "‚Äî";

  renderEmblemas();
}

function renderEmblemas() {
  emblemaGrid.innerHTML = "";
  const completedIds = Object.keys(state.completed);
  if (completedIds.length === 0) {
    const msg = document.createElement("div");
    msg.className = "emblema-text-desc";
    msg.textContent = "Nenhum emblema conquistado ainda. Conclua um percurso com nota ‚â• 80% para liberar o primeiro emblema Bronze.";
    emblemaGrid.appendChild(msg);
    return;
  }

  trilhaConvocacoes.tiers.forEach(tier => {
    tier.percursos.forEach(p => {
      if (!state.completed[p.id]) return;
      const card = document.createElement("div");
      card.className = "emblema-card";

      const icon = document.createElement("div");
      icon.className = "emblema-icon " + tier.medal;
      icon.textContent = medalEmoji[tier.medal];

      const textWrap = document.createElement("div");
      const title = document.createElement("div");
      title.className = "emblema-text-title " + tier.medal;
      title.textContent = `Emblema ${medalName[tier.medal]} ‚Äì ${p.titulo}`;

      const desc = document.createElement("div");
      desc.className = "emblema-text-desc";
      const s = state.completed[p.id];
      desc.textContent = `Conclu√≠do com ${s.score}/${p.questions.length} quest√µes (‚â•80%). XP +${s.xp}.`;

      textWrap.appendChild(title);
      textWrap.appendChild(desc);

      card.appendChild(icon);
      card.appendChild(textWrap);

      emblemaGrid.appendChild(card);
    });
  });
}

function updateAll() {
  renderPath();
  updateSummary();
}

updateAll();
</script>

</body>
</html>
